I forgot to screenshot the question. As I remember they want to know which registry key was modify when malware executed.

During my attempt. The flag format seem to be case-sensitive and confusing So I have to ask the staff for clarification of flag format.

To analysis malware ctf, I'm likely to start static analysis with virustotal.

![image-20240415012539778](./assets/image-20240415012539778.png)

https://www.virustotal.com/gui/file/bdb74765f6e99f2af997bb1916e373390aafa21100f8638c4d4dc89553fbba35

Look into Behavior tab. It's really seem to modify registry. But there too much possible answer. I need to narrow it's down.

![image-20240415013712608](./assets/image-20240415013712608.png)

So I look for runtime analysis report in community tab. And found a very interesting link.

![image-20240415013858589](./assets/image-20240415013858589.png)

```
https://app.any.run/tasks/806dfe0f-7633-4691-96bb-a421cba80d23
```

![image-20240415013943275](./assets/image-20240415013943275.png)

Click on the process 2124. I found that malware will modify the autorun registry.

![image-20240415014134883](./assets/image-20240415014134883.png)

![image-20240415014147706](./assets/image-20240415014147706.png)

```
HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN
```

But after I tried to submit for flag. It's not valid. After I consult with staff, they informed me that registry key was not in all upper-case.

So I open my windows vm, copy the registry key name and submit.

![image-20240415014504010](./assets/image-20240415014504010.png)

```
forensic{HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run}
```

But it's still not valid. So I consult staff again and found that my registry name was valid, but the "software" must be all upper-case like this.

```
forensic{HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run}
```

